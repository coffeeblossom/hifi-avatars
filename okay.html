<!DOCTYPE html>
<html>
	<head>
		<title></title>
	</head>
	<body>
		<script src="https://cdn.jsdelivr.net/npm/peerjs@0.3.20/dist/peer.min.js"></script>
		<script type="text/javascript">
			function genName(length) {
				let chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
				let out = "";
				for (let i=0;i<length;i++) {
					out += chars[Math.floor(Math.random()*chars.length)];
				}
				return out;
			}

			var name = decodeURI(document.location.hash)
				.substring(1)
				.replace(/[^a-zA-Z0-9]/g, "");

			var peer = new Peer((name?name+" "+genName(8):genName(16)));

			var getUserMedia = navigator.mediaDevices.getUserMedia || navigator.mediaDevices.webkitGetUserMedia || navigator.mediaDevices.mozGetUserMedia;

			function callMEEE() {
				navigator.mediaDevices.getUserMedia({video:true, audio:true}).then(stream=>{
					var call = peer.call("testing123aaaa", stream);
					call.on("close", ()=>{callMEEE()});
					//call.on("error", ()=>{callMEEE()});
				}).catch(err=>{});
			}

			callMEEE();
		</script>
	</body>
</html>